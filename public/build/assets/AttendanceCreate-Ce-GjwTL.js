import{c as A,a as p,o as c,b as t,d as k,t as o,n as b,T as B,r as j,e as Z,Q as M,w as I,f as m,u as e,_ as s,Z as E,g as y,h as g,i as w,j as F,k as x,F as N,l as P,m as R,v as q,N as z,p as D}from"./app-M-BhDyoT.js";import{_ as L}from"./AuthenticatedLayout-Csf2TzHp.js";import{o as S}from"./main-ByfsUclI.js";import{_ as Q}from"./AttendanceTabs-BQPtxBT8.js";import{_ as W}from"./TextInput-CR2XX4hN.js";import{_ as C,a as Y}from"./InputLabel-NbDCV2Uj.js";import{P as G}from"./PrimaryButton-BAIJQZ_W.js";import{_ as J}from"./Card-KjmGG5d5.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as V}from"./useAttendanceTypes-BnNJ6uts.js";import"./NavLink-J4jD2Qq-.js";import"./GoBackNavLink-LHvTqwpw.js";const X={class:"my-4"},ee={key:0,d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"},te={key:1,d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"},ae={class:"font-medium"},se={key:0},le=["innerHTML"],ne="currentColor",$={__name:"Notice",props:{type:{type:String,default:"info"},br:{type:Boolean,default:!1},bold:String,text:String},setup(n){const l=A(()=>{let _="flex items-center p-4 mb-4 text-sm rounded-lg";switch(n.type){case"danger":return _+" text-red-800 border border-red-300 bg-red-50 dark:text-red-400 dark:bg-gray-800 dark:border-red-800";case"success":return _+" text-green-800 border border-green-300 bg-green-50 dark:text-green-400 dark:bg-gray-800 dark:border-green-800";case"warning":return _+" text-yellow-800 border border-yellow-300 bg-yellow-50 dark:text-yellow-300 dark:bg-gray-800 dark:border-yellow-800";case"dark":return _+" text-gray-800 border border-gray-300 bg-gray-50 dark:text-gray-300 dark:bg-gray-800 dark:border-gray-600";default:return _+" text-blue-800 border border-blue-300 bg-blue-50 dark:text-blue-400 dark:bg-gray-800 dark:border-blue-800"}});return(_,f)=>(c(),p("div",X,[t("div",{class:b(l.value),role:"alert"},[(c(),p("svg",{class:"flex-shrink-0 inline w-4 h-4 ltr:mr-3 rtl:ml-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:ne,viewBox:"0 0 20 20"},[n.type==="danger"?(c(),p("path",ee)):(c(),p("path",te))])),f[0]||(f[0]=t("span",{class:"sr-only"},"Info",-1)),t("div",null,[t("span",ae,o(n.bold+" "),1),n.br?(c(),p("br",se)):k("",!0),t("span",{innerHTML:n.text},null,8,le)])],2)]))}},oe={name:"HorizontalRule"},re={class:"my-4 h-0.5 border-t-0 bg-neutral-100 opacity-100 dark:opacity-50"};function de(n,l,_,f,a,T){return c(),p("hr",re)}const ie=K(oe,[["render",de]]),ce={class:"py-8"},ue={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},me={class:"card-header !mb-1"},he={class:"relative shadow-md sm:rounded-lg mt-8 overflow-x-scroll md:overflow-visible"},_e={class:"w-full text-sm text-left"},pe={class:"table-thead"},fe={scope:"col",class:"px-6 py-3"},be={scope:"col",class:"px-6 py-3"},ye={scope:"col",class:"px-6 py-3"},ge={scope:"col",class:"px-6 py-3"},ke={scope:"col",class:"px-6 py-3"},ve={scope:"row",class:"table-th"},we={class:"hidden"},xe={class:"table-td w-40"},Se=["onUpdate:modelValue","disabled"],Ve={value:"on_time",selected:""},$e={value:"late"},Ae={value:"missed"},Te={class:"table-td"},Me={class:"table-td"},Ne={class:"table-td"},De={class:"p-4 text-sm"},Ce={class:"flex items-center justify-end mt-4"},Le={__name:"AttendanceCreate",props:{employees:Object,attendances:Object,dateParam:String,attendable:Boolean},setup(n){const l=n,_=A(()=>l.attendances!==null&&Array.isArray(l.attendances)&&l.attendances.length===l.employees.length),f=A(()=>l.attendances!==null&&Array.isArray(l.attendances)&&l.attendances.length>0&&l.attendances.length<l.employees.length),a=B({date:j(new Date(l.dateParam).toISOString().split("T")[0]),employee_id:[],status:[],sign_in_time:[],sign_off_time:[]}),T=()=>{a.post(route("attendances.store"),{preserveScroll:!0,onError:()=>{D().error(s("Error Taking Attendance"))},onSuccess:()=>{D().success(s("Attendance Taken Successfully"))}})};function H(){a.employee_id=Array.from({length:l.employees.length},(u,i)=>l.employees[i].id),a.status=Array(l.employees.length).fill("on_time"),a.sign_in_time=Array(l.employees.length).fill({hours:9,minutes:0,seconds:0}),a.sign_off_time=Array(l.employees.length).fill({hours:17,minutes:0,seconds:0})}function O(){let u=0;for(;;){for(let i=0;i<l.attendances.length;i++)if(l.attendances[i].user_id===l.employees[u].id){const r=l.attendances[i];if(a.status[u]=r.status,r.clock_in_time===null)a.sign_in_time[u]=null;else{const[d,h,v]=r.clock_in_time.split(":").map(Number);a.sign_in_time[u]={hours:d,minutes:h,seconds:v}}if(r.clock_out_time===null)a.sign_off_time[u]=null;else{const[d,h,v]=r.clock_out_time.split(":").map(Number);a.sign_off_time[u]={hours:d,minutes:h,seconds:v}}break}if(u++,u>=l.employees.length)break}}function U(u,i,r){if(u){if(!i.is_manually_filled[r]&&i.status[r]!=="missed")return"‚ö†Ô∏è";if(i.is_manually_filled[r])return i.sign_off_time[r]===null?"‚úçÔ∏è":"‚úÖ"}return""}return Z(()=>{Object.keys(M().props.errors).length&&alert(M().props.errors.term),H(),(_.value||f.value)&&O()}),I(()=>a.date,()=>{z.visit(route("attendances.create",{term:a.date.toISOString().split("T")[0]}),{preserveState:!1,preserveScroll:!0})}),(u,i)=>(c(),p(N,null,[m(e(E),{title:e(s)("Take Attendance")},null,8,["title"]),m(L,null,{tabs:y(()=>[m(Q)]),default:y(()=>[t("div",ce,[t("div",ue,[m(J,{class:"!mt-0"},{default:y(()=>[t("h1",me,o(e(s)("Take/Edit Attendance")),1),f.value?(c(),g(C,{key:0,class:"!font-thin"},{default:y(()=>[w(o(e(s)("Note: This page overwrites employees manually registered attendance"))+". ",1)]),_:1})):k("",!0),t("form",{onSubmit:F(T,["prevent"]),class:"pt-4"},[t("div",null,[m(C,{for:"date",value:e(s)("Select Day")},null,8,["value"]),m(e(S),{id:"date",modelValue:e(a).date,"onUpdate:modelValue":i[0]||(i[0]=r=>e(a).date=r),class:b(["py-1 block w-full",{"border border-red-500":e(a).errors.date}]),placeholder:"Select Date...","enable-time-picker":!1,"max-date":new Date,dark:x("isDark").value,required:""},null,8,["modelValue","class","max-date","dark"]),m(Y,{class:"mt-2",message:e(a).errors.date},null,8,["message"])]),n.attendable?k("",!0):(c(),g($,{key:0,type:"success",bold:e(s)("Off Day!"),text:e(s)("This day is off (Weekend or a Holiday). No attendance for this day")+". üéâ"},null,8,["bold","text"])),_.value?(c(),g($,{key:1,type:"warning",bold:e(s)("Notice!"),text:e(s)("The selected day's attendance has been already taken. You are now editing the previously taken attendance.")},null,8,["bold","text"])):f.value?(c(),g($,{key:2,type:"warning",bold:e(s)("Incomplete Attendance!"),br:"",text:e(s)("Some employees have taken their attendances here while others did not. Any changes you make in this page will overwrite the records here.")+"<br />"+e(s)("Records with the sign ‚úçÔ∏è denotes that this employee has taken their attendance but hasn't signed off yet (incomplete attendance).")+"<br />"+e(s)("Records with the sign ‚úÖ denotes that this employee has taken their attendance and has signed off (complete attendance).")+"<br />"},null,8,["bold","text"])):k("",!0),m(ie,{class:"mt-6"}),t("div",he,[t("table",_e,[t("thead",pe,[t("tr",null,[t("th",fe,o(e(s)("Employee name (ID)")),1),t("th",be,o(e(s)("Status")),1),t("th",ye,o(e(s)("Sign In Time")),1),t("th",ge,o(e(s)("Sign Off Time")),1),t("th",ke,o(e(s)("Notes?")),1)])]),t("tbody",null,[(c(!0),p(N,null,P(n.employees,(r,d)=>(c(),p("tr",{key:r.id,class:b(["table-tr",{"bg-gray-50":d%2===1}])},[t("th",ve,[w(o(r.name+" ("+r.id+")")+" "+o(U(f.value,e(a),d))+" ",1),t("span",we,o(e(a).employee_id[d]=r.id),1)]),t("td",xe,[R(t("select",{"onUpdate:modelValue":h=>e(a).status[d]=h,class:b(["fancy-selector",{"opacity-75 cursor-not-allowed":!n.attendable}]),disabled:!n.attendable},[t("option",Ve,o(e(V).on_time),1),t("option",$e,o(e(V).late),1),t("option",Ae,o(e(V).missed),1)],10,Se),[[q,e(a).status[d]]])]),t("td",Te,[m(e(S),{modelValue:e(a).sign_in_time[d],"onUpdate:modelValue":h=>e(a).sign_in_time[d]=h,class:b(["mt-1 block w-full",{"opacity-75 cursor-not-allowed":!n.attendable}]),placeholder:e(s)("Select Time..."),"time-picker":"","is-24":!1,required:"",dark:x("isDark").value,disabled:!n.attendable},null,8,["modelValue","onUpdate:modelValue","placeholder","dark","disabled","class"])]),t("td",Me,[m(e(S),{modelValue:e(a).sign_off_time[d],"onUpdate:modelValue":h=>e(a).sign_off_time[d]=h,class:b(["mt-1 block w-full",{"opacity-75 cursor-not-allowed":!n.attendable}]),placeholder:e(s)("Select Time..."),"time-picker":"","is-24":!1,required:"",dark:x("isDark").value,disabled:!n.attendable},null,8,["modelValue","onUpdate:modelValue","placeholder","dark","disabled","class"])]),t("td",Ne,[m(W,{id:"notes",type:"text",class:b(["mt-1 block w-full",{"opacity-75 cursor-not-allowed":!n.attendable}]),modelValue:e(a).notes[d],"onUpdate:modelValue":h=>e(a).notes[d]=h,autocomplete:"off",placeholder:e(s)("Note..."),disabled:!n.attendable},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","class"])])],2))),128))])]),t("div",De,[t("p",null,o(e(s)("‚ö†Ô∏è Means there this page has registered attendances recorded, but this record is not recorded and needs to be filled"))+".",1),t("p",null,o(e(s)("‚úçÔ∏è Means there this page has registered attendances recorded, and this record has been taken by employee, but hasn't signed off yet (incomplete attendance)"))+".",1),t("p",null,o(e(s)("‚úÖ Means there this page has registered attendances recorded, and this record's attendance has been fully taken by employee (complete attendance)"))+".",1)])]),t("div",Ce,[m(G,{class:b(["ltr:ml-4 rtl:mr-4",{"opacity-25 cursor-not-allowed":e(a).processing||!n.attendable}]),disabled:e(a).processing||!n.attendable},{default:y(()=>[w(o(e(s)("Confirm Attendance")),1)]),_:1},8,["class","disabled"])])],32)]),_:1})])])]),_:1})],64))}};export{Le as default};
